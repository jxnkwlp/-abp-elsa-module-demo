(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[164],{57529:function(){},38520:function(Re,re,e){"use strict";e.r(re),e.d(re,{default:function(){return Ue}});var z=e(13062),Y=e(71230),Ee=e(38663),j=e(57529),W=e(22122),P=e(96156),s=e(67294),Ze=e(94184),L=e.n(Ze),Ie=e(7085),H=e(65632),fe=function(E,l){var f={};for(var n in E)Object.prototype.hasOwnProperty.call(E,n)&&l.indexOf(n)<0&&(f[n]=E[n]);if(E!=null&&typeof Object.getOwnPropertySymbols=="function")for(var y=0,n=Object.getOwnPropertySymbols(E);y<n.length;y++)l.indexOf(n[y])<0&&Object.prototype.propertyIsEnumerable.call(E,n[y])&&(f[n[y]]=E[n[y]]);return f},q=function(l){var f,n,y=l.prefixCls,K=l.className,M=l.color,x=M===void 0?"blue":M,w=l.dot,U=l.pending,ie=U===void 0?!1:U,oe=l.position,J=l.label,G=l.children,A=fe(l,["prefixCls","className","color","dot","pending","position","label","children"]),$=s.useContext(H.E_),te=$.getPrefixCls,u=te("timeline",y),t=L()((f={},(0,P.Z)(f,"".concat(u,"-item"),!0),(0,P.Z)(f,"".concat(u,"-item-pending"),ie),f),K),ne=L()((n={},(0,P.Z)(n,"".concat(u,"-item-head"),!0),(0,P.Z)(n,"".concat(u,"-item-head-custom"),!!w),(0,P.Z)(n,"".concat(u,"-item-head-").concat(x),!0),n)),k=/blue|red|green|gray/.test(x||"")?void 0:x;return s.createElement("li",(0,W.Z)({},A,{className:t}),J&&s.createElement("div",{className:"".concat(u,"-item-label")},J),s.createElement("div",{className:"".concat(u,"-item-tail")}),s.createElement("div",{className:ne,style:{borderColor:k,color:k}},w),s.createElement("div",{className:"".concat(u,"-item-content")},G))},se=q,ee=e(96159),me=function(E,l){var f={};for(var n in E)Object.prototype.hasOwnProperty.call(E,n)&&l.indexOf(n)<0&&(f[n]=E[n]);if(E!=null&&typeof Object.getOwnPropertySymbols=="function")for(var y=0,n=Object.getOwnPropertySymbols(E);y<n.length;y++)l.indexOf(n[y])<0&&Object.prototype.propertyIsEnumerable.call(E,n[y])&&(f[n[y]]=E[n[y]]);return f},V=function(l){var f,n=s.useContext(H.E_),y=n.getPrefixCls,K=n.direction,M=l.prefixCls,x=l.pending,w=x===void 0?null:x,U=l.pendingDot,ie=l.children,oe=l.className,J=l.reverse,G=J===void 0?!1:J,A=l.mode,$=A===void 0?"":A,te=me(l,["prefixCls","pending","pendingDot","children","className","reverse","mode"]),u=y("timeline",M),t=typeof w=="boolean"?null:w,ne=w?s.createElement(se,{pending:!!w,dot:U||s.createElement(Ie.Z,null)},t):null,k=s.Children.toArray(ie);k.push(ne),G&&k.reverse();var ue=function(N,D){return $==="alternate"?N.props.position==="right"?"".concat(u,"-item-right"):N.props.position==="left"||D%2==0?"".concat(u,"-item-left"):"".concat(u,"-item-right"):$==="left"?"".concat(u,"-item-left"):$==="right"||N.props.position==="right"?"".concat(u,"-item-right"):""},de=k.filter(function(C){return!!C}),ae=s.Children.count(de),ce="".concat(u,"-item-last"),ve=s.Children.map(de,function(C,N){var D=N===ae-2?ce:"",Se=N===ae-1?ce:"";return(0,ee.Tm)(C,{className:L()([C.props.className,!G&&!!w?D:Se,ue(C,N)])})}),ye=k.some(function(C){var N;return!!((N=C==null?void 0:C.props)===null||N===void 0?void 0:N.label)}),xe=L()(u,(f={},(0,P.Z)(f,"".concat(u,"-pending"),!!w),(0,P.Z)(f,"".concat(u,"-reverse"),!!G),(0,P.Z)(f,"".concat(u,"-").concat($),!!$&&!ye),(0,P.Z)(f,"".concat(u,"-label"),ye),(0,P.Z)(f,"".concat(u,"-rtl"),K==="rtl"),f),oe);return s.createElement("ul",(0,W.Z)({},te,{className:xe}),ve)};V.Item=se;var pe=V,Q=pe,h=e(20136),p=e(55241),Z=e(402),b=e(61859),m=e(89032),I=e(15746),tt=e(58024),be=e(39144),nt=e(71153),le=e(60331),at=e(17462),Te=e(76772),rt=e(71194),Ne=e(50146),ge=e(3182),T=e(2824),$e=e(94043),X=e.n($e),he=e(49684),ke=e(41180),Pe=e(90774),We=e(78338),Le=e(67265),Me=e(30381),Ge=e.n(Me),Ce=e(51615),Be=e(45187),Ye=e(87831),g=e(85893),Ke=function(){var l,f,n,y,K=(0,Ce.k6)(),M=(0,Ce.TH)(),x=(0,s.useRef)(),w=s.useState(),U=(0,T.Z)(w,2),ie=U[0],oe=U[1],J=s.useState(),G=(0,T.Z)(J,2),A=G[0],$=G[1],te=s.useState(),u=(0,T.Z)(te,2),t=u[0],ne=u[1],k=s.useState(!1),ue=(0,T.Z)(k,2),de=ue[0],ae=ue[1],ce=s.useState(),ve=(0,T.Z)(ce,2),ye=ve[0],xe=ve[1],C=s.useState(),N=(0,T.Z)(C,2),D=N[0],Se=N[1],Je=s.useState([]),Oe=(0,T.Z)(Je,2),B=Oe[0],Fe=Oe[1],ze=s.useState("logs"),je=(0,T.Z)(ze,2),_=je[0],He=je[1],Ve=s.useState(!1),we=(0,T.Z)(Ve,2),De=we[0],Qe=we[1],Xe=function(){var o=(0,ge.Z)(X().mark(function a(d,r){var c,v,i,R;return X().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,(0,ke.lE)(d,r);case 2:if(i=S.sent,i){S.next=6;break}return Ne.Z.error({title:"Error",content:"The workflow defintion does not exist.",onOk:function(){K.goBack()}}),S.abrupt("return");case 6:return xe(i),S.next=9,(0,Ye.MI)((c=i.activities)!==null&&c!==void 0?c:[],(v=i.connections)!==null&&v!==void 0?v:[]);case 9:R=S.sent,Se(R);case 11:case"end":return S.stop()}},a)}));return function(d,r){return o.apply(this,arguments)}}(),Ae=function(){var o=(0,ge.Z)(X().mark(function a(d){var r,c;return X().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,(0,Pe.jP)(d);case 2:c=i.sent,Fe((r=c==null?void 0:c.items)!==null&&r!==void 0?r:[]);case 4:case"end":return i.stop()}},a)}));return function(d){return o.apply(this,arguments)}}(),_e=function(){var o=(0,ge.Z)(X().mark(function a(d){var r;return X().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return ae(!0),v.next=3,(0,Pe.mV)(d);case 3:return r=v.sent,v.next=6,Ae(d);case 6:if(!r){v.next=11;break}ne(r),$(r==null?void 0:r.name),v.next=13;break;case 11:return Ne.Z.error({title:"Error",content:"The workflow instance does not exist.",onOk:function(){K.goBack()}}),v.abrupt("return");case 13:return v.next=15,Xe(r.definitionId,r.version);case 15:ae(!1);case 16:case"end":return v.stop()}},a)}));return function(d){return o.apply(this,arguments)}}(),qe=function(a){var d;D==null||(d=D.edges)===null||d===void 0||d.filter(function(r){var c;return((c=r.target)===null||c===void 0?void 0:c.cell)==a}).forEach(function(r){var c=B.filter(function(O){var S;return O.activityId===((S=r.source)===null||S===void 0?void 0:S.cell)});if(c.findIndex(function(O){return O.eventName=="Executed"})>=0){var v;(v=x.current)===null||v===void 0||v.setEdgeStyle(r.id,"success")}else if(c.findIndex(function(O){return O.eventName=="Executing"})>=0){var i;(i=x.current)===null||i===void 0||i.setEdgeStyle(r.id,"processing")}else if(c.findIndex(function(O){return O.eventName=="Faulted"})>=0){var R;(R=x.current)===null||R===void 0||R.setEdgeStyle(r.id,"error")}})},et=function(a){var d=B.filter(function(i){return i.activityId===a});if(d.findIndex(function(i){return i.eventName=="Executed"})>=0){var r;(r=x.current)===null||r===void 0||r.setNodeStyle(a,"success")}else if(d.findIndex(function(i){return i.eventName=="Executing"})>=0){var c;(c=x.current)===null||c===void 0||c.setNodeStyle(a,"processing")}else if(d.findIndex(function(i){return i.eventName=="Faulted"})>=0){var v;(v=x.current)===null||v===void 0||v.setNodeStyle(a,"error")}qe(a)};return(0,s.useEffect)(function(){if(B&&De&&D){var o,a,d,r;(o=x.current)===null||o===void 0||o.setAllNodesStyle("default"),(a=x.current)===null||a===void 0||a.setAllEdgesStyle("default");var c={};(B??[]).forEach(function(S){var F=c[S.activityId];F?F.push(S):c[S.activityId]=[S]});for(var v in c)et(v);if(t!=null&&(d=t.currentActivity)!==null&&d!==void 0&&d.activityId){var i,R;(i=x.current)===null||i===void 0||i.setNodeStyle(t.currentActivity.activityId,"processing"),(R=x.current)===null||R===void 0||R.setNodeIncomingEdgesStyle(t.currentActivity.activityId,"processing")}if(t!=null&&(r=t.fault)!==null&&r!==void 0&&r.faultedActivityId){var O;(O=x.current)===null||O===void 0||O.setNodeStyle(t.fault.faultedActivityId,"error")}t!=null&&t.blockingActivities&&t.blockingActivities.forEach(function(S){var F;(F=x.current)===null||F===void 0||F.setNodeStyle(S.activityId,"processing")})}},[t,B,De,D]),(0,s.useEffect)(function(){var o,a,d=(o=M==null||(a=M.state)===null||a===void 0?void 0:a.id)!==null&&o!==void 0?o:"";if(!d){K.goBack();return}oe(d),_e(d)},[]),(0,g.jsxs)(Le.ZP,{title:A,loading:de,children:[(t==null?void 0:t.fault)&&(0,g.jsx)(Te.Z,{showIcon:!0,message:t==null?void 0:t.fault.message,type:"error",description:"",style:{marginBottom:10}}),(0,g.jsxs)(Y.Z,{gutter:16,children:[(0,g.jsx)(I.Z,{span:14,children:(0,g.jsx)(be.Z,{title:["Graph ",(0,g.jsx)(le.Z,{children:t==null?void 0:t.version},"2"),(0,g.jsx)(le.Z,{children:he.x8[t==null?void 0:t.workflowStatus]},"3")],children:(0,g.jsx)(Be.Z,{readonly:!0,actionRef:x,showMiniMap:!1,showNodeTypes:!1,showToolbar:!1,graphData:D,onDataUpdate:function(a){Qe(!0)}})})}),(0,g.jsx)(I.Z,{span:10,children:(0,g.jsxs)(be.Z,{title:"",tabProps:{},activeTabKey:_,tabList:[{key:"logs",tab:"Logs"},{key:"input",tab:"Input"},{key:"fault",tab:"Fault"},{key:"variables",tab:"Variables"},{key:"data",tab:"Data"}],onTabChange:function(a){He(a)},children:[_==="logs"&&(0,g.jsx)(Q,{mode:"left",pending:(t==null?void 0:t.workflowStatus)==he.x8.Running||(t==null?void 0:t.workflowStatus)==he.x8.Suspended,children:B.map(function(o){var a;return(0,g.jsx)(Q.Item,{color:o.eventName=="Executing"?"gray":o.eventName=="Faulted"?"red":"green",dot:o.eventName=="Executing"?(0,g.jsx)(We.Z,{style:{fontSize:"12px"}}):null,children:(0,g.jsxs)(p.Z,{title:"Data",placement:"left",content:(0,g.jsx)(b.Z.Paragraph,{style:{display:"block",maxWidth:500,overflow:"hidden",wordWrap:"break-word"},copyable:!0,children:JSON.stringify((a=o.data)!==null&&a!==void 0?a:{})}),children:[o.eventName," ",(0,g.jsx)(le.Z,{children:o.activityType}),(0,g.jsx)(le.Z,{children:Ge()(o.timestamp).format("YYYY-MM-DD HH:mm:ss")}),(0,g.jsx)("p",{children:o.message})]})},o.id)})}),_==="input"&&(0,g.jsx)(b.Z.Paragraph,{copyable:!0,children:JSON.stringify((l=t==null?void 0:t.input)!==null&&l!==void 0?l:{})}),_==="fault"&&(0,g.jsx)(b.Z.Paragraph,{copyable:!0,children:JSON.stringify((f=t==null?void 0:t.fault)!==null&&f!==void 0?f:{})}),_==="variables"&&(0,g.jsx)(b.Z.Paragraph,{copyable:!0,children:JSON.stringify((n=t==null?void 0:t.variables)!==null&&n!==void 0?n:{})}),_==="data"&&(0,g.jsx)(b.Z.Paragraph,{copyable:!0,children:JSON.stringify((y=t==null?void 0:t.activityData)!==null&&y!==void 0?y:{})})]})})]})]})},Ue=Ke},90774:function(Re,re,e){"use strict";e.d(re,{aT:function(){return P},mV:function(){return fe},jP:function(){return se},qd:function(){return me},C4:function(){return pe}});var z=e(11849),Y=e(3182),Ee=e(94043),j=e.n(Ee),W=e(21010);function P(h,p){return s.apply(this,arguments)}function s(){return s=(0,Y.Z)(j().mark(function h(p,Z){return j().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",(0,W.WY)("/api/workflow-instances/".concat(p,"/cancel"),(0,z.Z)({method:"POST",getResponse:!0},Z||{})));case 1:case"end":return m.stop()}},h)})),s.apply(this,arguments)}function Ze(h,p,Z){return L.apply(this,arguments)}function L(){return L=_asyncToGenerator(_regeneratorRuntime.mark(function h(p,Z,b){return _regeneratorRuntime.wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.abrupt("return",request("/api/workflow-instances/".concat(p,"/dispatch"),_objectSpread({method:"POST",data:Z,getResponse:!0},b||{})));case 1:case"end":return I.stop()}},h)})),L.apply(this,arguments)}function Ie(h,p,Z){return H.apply(this,arguments)}function H(){return H=_asyncToGenerator(_regeneratorRuntime.mark(function h(p,Z,b){return _regeneratorRuntime.wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.abrupt("return",request("/api/workflow-instances/".concat(p,"/execute"),_objectSpread({method:"POST",data:Z,getResponse:!0},b||{})));case 1:case"end":return I.stop()}},h)})),H.apply(this,arguments)}function fe(h,p){return q.apply(this,arguments)}function q(){return q=(0,Y.Z)(j().mark(function h(p,Z){return j().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",(0,W.WY)("/api/workflow-instances/".concat(p),(0,z.Z)({method:"GET"},Z||{})));case 1:case"end":return m.stop()}},h)})),q.apply(this,arguments)}function se(h,p){return ee.apply(this,arguments)}function ee(){return ee=(0,Y.Z)(j().mark(function h(p,Z){return j().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",(0,W.WY)("/api/workflow-instances/".concat(p,"/execution-logs"),(0,z.Z)({method:"GET"},Z||{})));case 1:case"end":return m.stop()}},h)})),ee.apply(this,arguments)}function me(h,p){return V.apply(this,arguments)}function V(){return V=(0,Y.Z)(j().mark(function h(p,Z){return j().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",(0,W.WY)("/api/workflow-instances",(0,z.Z)({method:"GET",params:p},Z||{})));case 1:case"end":return m.stop()}},h)})),V.apply(this,arguments)}function pe(h,p,Z){return Q.apply(this,arguments)}function Q(){return Q=(0,Y.Z)(j().mark(function h(p,Z,b){return j().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.abrupt("return",(0,W.WY)("/api/workflow-instances/".concat(p,"/retry"),(0,z.Z)({method:"POST",data:Z,getResponse:!0},b||{})));case 1:case"end":return I.stop()}},h)})),Q.apply(this,arguments)}}}]);
