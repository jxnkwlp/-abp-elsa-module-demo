(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[853],{61201:function(xa,je,a){"use strict";var Ue=a(3182),we=a(94043),Ee=a.n(we),ge=a(49684),be=a(5966),Oe=a(90672),Je=a(52688),ve=a(64317),ee=a(85893),Te=function(){return(0,ee.jsxs)(ee.Fragment,{children:[(0,ee.jsx)(be.Z,{label:"Name",name:"name",rules:[{required:!0},{max:32}]}),(0,ee.jsx)(be.Z,{label:"Display Name",name:"displayName",rules:[{required:!0},{max:64}]}),(0,ee.jsx)(Oe.Z,{label:"Description",name:"description",fieldProps:{rows:2,autoSize:{minRows:2,maxRows:5}},rules:[{max:128}]}),(0,ee.jsx)(Je.Z,{label:"Singleton",name:"isSingleton"}),(0,ee.jsx)(be.Z,{label:"Tag",name:"tag"}),(0,ee.jsx)(ve.Z,{label:"Persistence Behavior",name:"persistenceBehavior",request:(0,Ue.Z)(Ee().mark(function Fe(){return Ee().wrap(function(H){for(;;)switch(H.prev=H.next){case 0:return H.abrupt("return",Object.keys(ge.TC).filter(function(ye){return parseInt(ye)>=0}).map(function(ye){return{value:parseInt(ye),label:ge.TC[ye]}}));case 1:case"end":return H.stop()}},Fe)})),initialValue:ge.TC.WorkflowBurst})]})};je.Z=Te},39285:function(xa,je,a){"use strict";a.r(je),a.d(je,{default:function(){return ka}});var Ue=a(71194),we=a(50146),Ee=a(58024),ge=a(39144),be=a(20228),Oe=a(11382),Je=a(13062),ve=a(71230),ee=a(59250),Te=a(13013),Za=a(43185),Fe=a(94412),$a=a(30887),H=a(18515),ye=a(57663),Ve=a(71577),Rt=a(89032),ae=a(15746),Ct=a(402),ja=a(61859),Pt=a(71153),ke=a(60331),Re=a(86582),Le=a(32059),Dt=a(34792),Q=a(48086),j=a(11849),F=a(3182),wt=a(9715),ze=a(17681),y=a(2824),ba=a(94043),p=a.n(ba),Ra=a(64322),Se=a(41180),Ca=a(92104),Pa=a(24557),Ne=a(37476),Da=a(67265),wa=a(10926),Ea=a(51086),Oa=a(96486),m=a(67294),Ge=a(51615),Ta=a(61201),Fa=a(45187),Et=a(18106),Me=a(16004),xe=a(952),Va=a(63434),La=a(52688),Ce=a(64317),Ye=a(90672),Pe=a(5966),He=a(24739),Qe=a(97462),Na=a(59962),X=a(87831),Ma=a(62602),Ze=a(26565),Aa=a(81493),e=a(85893),Wa=function(v){var A=m.createRef(),le=m.useState(v.value||""),K=(0,y.Z)(le,1),W=K[0],te=m.useState(!1),ne=(0,y.Z)(te,2),I=ne[0],re=ne[1],se=m.useState(),U=(0,y.Z)(se,2),l=U[0],B=U[1],V=m.useState(),s=(0,y.Z)(V,2),x=s[0],N=s[1],D=function(f){var R;v==null||(R=v.onChange)===null||R===void 0||R.call(v,f)},b=function(){I?(re(!1),N(l)):(re(!0),N({w:document.body.clientWidth,h:document.body.clientHeight}))},u=function(){var P=(0,F.Z)(p().mark(function f(){var R;return p().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:if(!v.getJavaScriptLibs){O.next=5;break}return O.next=3,v.getJavaScriptLibs();case 3:R=O.sent,(R==null?void 0:R.length)>0&&(Ze.languages.typescript.javascriptDefaults.setExtraLibs(R??[]),R.forEach(function(h){var fe=Ze.editor.getModel(Ze.Uri.parse(h.filePath));fe&&fe.dispose(),Ze.editor.createModel(h.content,"typescript",Ze.Uri.parse(h.filePath))}));case 5:case"end":return O.stop()}},f)}));return function(){return P.apply(this,arguments)}}();return(0,m.useEffect)(function(){var P,f;B({w:v.width,h:(P=v.height)!==null&&P!==void 0?P:150}),N({w:v.width,h:(f=v.height)!==null&&f!==void 0?f:150})},[0]),(0,m.useEffect)(function(){v.language=="javascript"&&u()},[v.language]),(0,e.jsxs)("div",{className:I?"monaco-editor-container fullscreen":"monaco-editor-container",id:v.id,style:{width:x==null?void 0:x.w,height:x==null?void 0:x.h},onKeyDown:function(f){f.code=="Escape"&&(I&&b(),f.preventDefault(),f.stopPropagation())},children:[(0,e.jsx)(Aa.ZP,{ref:A,language:v.language,onChange:function(f){D(f)},options:(0,j.Z)({minimap:{enabled:I},wordWrap:"bounded",wordWrapColumn:1024,automaticLayout:!0,autoIndent:"full",tabSize:2,autoClosingBrackets:"languageDefined",foldingStrategy:"auto"},v==null?void 0:v.options),editorDidMount:function(f){f.setValue(W==null?void 0:W.toString())}}),(0,e.jsx)("div",{className:"fullscreen-toggle",children:(0,e.jsx)("a",{onClick:function(){return b()},title:"Toggle fullscreen",children:(0,e.jsx)(Ma.Z,{})})})]})},Ae=Wa,Ia=function(v){var A,le=m.useState([]),K=(0,y.Z)(le,2),W=K[0],te=K[1],ne=m.useState(!1),I=(0,y.Z)(ne,2),re=I[0],se=I[1],U=m.useState((A=v==null?void 0:v.title)!==null&&A!==void 0?A:"Cases Edit"),l=(0,y.Z)(U,2),B=l[0],V=l[1],s=ze.Z.useForm(),x=(0,y.Z)(s,1),N=x[0];return(0,m.useEffect)(function(){var D;te(JSON.parse((D=v==null?void 0:v.value)!==null&&D!==void 0?D:"[]"))},[N,v]),(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(ve.Z,{children:[(0,e.jsx)(ae.Z,{flex:1,children:(0,e.jsx)("div",{style:{wordBreak:"break-all"},children:JSON.stringify(W??[])})}),(0,e.jsx)(ae.Z,{children:(0,e.jsx)(Ve.Z,{type:"default",onClick:function(){se(!0),N.setFieldsValue({input:W})},children:"Configure"})})]}),(0,e.jsx)(Ne.Y,{form:N,title:B,width:680,layout:"horizontal",labelCol:{span:4},modalProps:{destroyOnClose:!0,maskClosable:!1},visible:re,onVisibleChange:se,initialValues:W,onFinish:function(){var D=(0,F.Z)(p().mark(function b(u){var P,f,R;return p().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return te((P=u==null?void 0:u.input)!==null&&P!==void 0?P:[]),(f=v.onChange)===null||f===void 0||f.call(v,JSON.stringify((R=u==null?void 0:u.input)!==null&&R!==void 0?R:[])),O.abrupt("return",!0);case 3:case"end":return O.stop()}},b)}));return function(b){return D.apply(this,arguments)}}(),grid:!0,children:(0,e.jsx)(Na.u,{name:"input",itemContainerRender:function(b){return(0,e.jsx)(He.UW,{children:b})},min:1,actionGuard:{beforeAddRow:function(b){return b={syntax:"JavaScript"},!0}},children:function(b,u,P){return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsx)(Pe.Z,{name:["name"],label:"Name",placeholder:"Name",rules:[{required:!0},{max:64}],colProps:{span:16}}),(0,e.jsx)(Ce.Z,{name:["syntax"],label:"Syntax",options:[{label:"JavaScript",value:"JavaScript"},{label:"Liquid",value:"Liquid"}],rules:[{required:!0}],allowClear:!1,colProps:{span:8}}),(0,e.jsxs)(ae.Z,{span:24,children:[(0,e.jsx)(Qe.Z,{name:["syntax"],children:function(R){var z=R.syntax;return z?(0,e.jsx)(xe.ZP.Item,{name:["expressions",z],rules:[{required:!0,message:"Required"}],children:(0,e.jsx)(Ae,{height:150,language:(0,X.dv)(z)})}):(0,e.jsx)("span",{})}}),(0,e.jsx)("div",{style:{borderBottom:"1px #eee solid",height:"1px",marginBottom:"15px"},className:"ant-col ant-col-24"})]})]})}})})]})},Xe=Ia,$e=20,Ba=4,Ka=function(v){var A=v.properties,le=m.useState("1"),K=(0,y.Z)(le,2),W=K[0],te=K[1];(0,m.useEffect)(function(){A.length>0&&te("2")},[]);var ne=function(){var U=(0,F.Z)(p().mark(function l(){var B;return p().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(v.workflowDefinitionId){s.next=2;break}return s.abrupt("return","");case 2:return s.next=4,(0,X.tm)(v.workflowDefinitionId);case 4:return B=s.sent,s.abrupt("return",B);case 6:case"end":return s.stop()}},l)}));return function(){return U.apply(this,arguments)}}(),I=function(l,B,V,s,x,N){if(V=="Default")switch(s.uiHint){case"check-list":return(0,e.jsx)(Va.Z.Group,(0,j.Z)((0,j.Z)({},x),{},{name:l,options:N,extra:s.hint,rules:[{required:s.isRequired}]}));case"checkbox":return(0,e.jsx)(La.Z,(0,j.Z)((0,j.Z)({},x),{},{name:l,extra:s.hint,rules:[{required:s.isRequired}]}));case"dropdown":return(0,e.jsx)(Ce.Z,(0,j.Z)((0,j.Z)({},x),{},{name:l,options:N,rules:[{required:s.isRequired}]}));case"multi-text":return(0,e.jsx)(Ce.Z,(0,j.Z)((0,j.Z)({},x),{},{name:l,options:N,fieldProps:{mode:"tags"},rules:[{required:s.isRequired}]}));case"multi-line":return(0,e.jsx)(Ye.Z,(0,j.Z)((0,j.Z)({},x),{},{name:l,fieldProps:{rows:2,autoSize:{minRows:2,maxRows:10},showCount:!1},rules:[{required:s.isRequired}]}));case"code-editor":return(0,e.jsx)(ae.Z,{span:$e,children:(0,e.jsx)(xe.ZP.Item,{label:x.label,name:l,required:s.isRequired,extra:s.hint,rules:[{required:s.isRequired}],children:(0,e.jsx)(Ae,{height:150,language:(0,X.dv)(V),getJavaScriptLibs:(0,F.Z)(p().mark(function D(){return p().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(V.toLocaleLowerCase()!="javascript"){u.next=6;break}return u.next=3,ne();case 3:return u.t0=u.sent,u.t1={content:u.t0,filePath:"script.d.ts"},u.abrupt("return",[u.t1]);case 6:return u.abrupt("return",[]);case 7:case"end":return u.stop()}},D)}))})})});case"switch-case-builder":return(0,e.jsx)(ae.Z,{span:$e,children:(0,e.jsx)(xe.ZP.Item,{label:x.label,name:l,required:s.isRequired,extra:s.hint,rules:[{required:s.isRequired}],children:(0,e.jsx)(Xe,{})})});default:return(0,e.jsx)(Pe.Z,(0,j.Z)((0,j.Z)({},x),{},{name:l,rules:[{required:s.isRequired}]}))}else if(V=="Switch")return(0,e.jsx)(ae.Z,{span:$e,children:(0,e.jsx)(xe.ZP.Item,{label:x.label,name:l,required:s.isRequired,extra:s.hint,rules:[{required:s.isRequired}],children:(0,e.jsx)(Xe,{})})});return(0,e.jsx)(ae.Z,{span:$e,children:(0,e.jsx)(xe.ZP.Item,{label:x.label,name:l,required:s.isRequired,extra:s.hint,rules:[{required:s.isRequired}],children:(0,e.jsx)(Ae,{height:150,language:(0,X.dv)(V),getJavaScriptLibs:(0,F.Z)(p().mark(function D(){return p().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(V.toLocaleLowerCase()!="javascript"){u.next=6;break}return u.next=3,ne();case 3:return u.t0=u.sent,u.t1={content:u.t0,filePath:"script.d.ts"},u.abrupt("return",[u.t1]);case 6:return u.abrupt("return",[]);case 7:case"end":return u.stop()}},D)}))})})})},re=function(){return(A??[]).map(function(l){var B,V,s,x,N=Array.isArray(l.options)?l.options.map(function(f){return{label:f.text,value:f.value}}):Array.isArray((B=l.options)===null||B===void 0?void 0:B.items)?(V=l.options)===null||V===void 0?void 0:V.items.map(function(f){return{label:f.text,value:f.value}}):null,D={label:l.label,readOnly:l.isReadOnly,placeholder:l.hint,colProps:{span:$e},required:l.isRequired},b=(0,X.Oq)(l),u=((s=b.supports)!==null&&s!==void 0?s:[]).map(function(f){return{label:f,key:f}});if(b.editor){var P;u=[{label:b.editor,key:(P=b.editor)!==null&&P!==void 0?P:"Literal"}]}else l.defaultSyntax!="Switch"&&(u=[{label:"Default",key:"Default"}].concat((0,Re.Z)(u)));return(0,e.jsxs)(He.UW,{children:[b.editor?I(["props",l.name,"expressions",(x=b.default)!==null&&x!==void 0?x:"Literal"],l.defaultValue,b.editor,l,D,N):(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(Qe.Z,{name:["name",["props",l.name,"syntax"]],children:function(R){var z,O=R.props,h=O==null||(z=O[l.name])===null||z===void 0?void 0:z.syntax;return I(["props",l.name,"expressions",h],l.defaultValue,h,l,D,N)}})}),(0,e.jsx)(Ce.Z,{name:["props",l.name,"syntax"],options:u.map(function(f){return{label:f.label,value:f.key}}),allowClear:!1,colProps:{span:Ba}})]},l.name)})},se=(0,m.useMemo)(function(){return re()},[v.properties,re]);return(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)(Me.Z,{defaultActiveKey:W,type:"line",style:{width:"100%",flex:1},children:[A.length>0&&(0,e.jsx)(Me.Z.TabPane,{tab:"Properties",children:(0,e.jsx)(ve.Z,{children:se})},"1"),(0,e.jsx)(Me.Z.TabPane,{tab:"Common",children:(0,e.jsxs)(ve.Z,{children:[(0,e.jsx)(Pe.Z,{label:"Name",name:"name",rules:[{required:!0},{max:32}]}),(0,e.jsx)(Pe.Z,{label:"Display Name",name:"displayName",rules:[{required:!0},{max:32}]}),(0,e.jsx)(Ye.Z,{label:"Description",name:"description",rules:[{max:128}],fieldProps:{autoSize:{minRows:2,maxRows:10}}})]})},"2")]})})},Ua=Ka,Ja=function(){var v,A=(0,Ge.TH)(),le=(0,Ge.k6)(),K=(0,m.useRef)(),W=m.useState(!1),te=(0,y.Z)(W,2),ne=te[0],I=te[1],re=m.useState(!1),se=(0,y.Z)(re,2),U=se[0],l=se[1],B=m.useState(),V=(0,y.Z)(B,2),s=V[0],x=V[1],N=m.useState(1),D=(0,y.Z)(N,2),b=D[0],u=D[1],P=m.useState(),f=(0,y.Z)(P,2),R=f[1],z=m.useState(),O=(0,y.Z)(z,2),h=O[0],fe=O[1],za=m.useState(),qe=(0,y.Z)(za,2),_e=qe[0],ea=qe[1],Ga=m.useState(),aa=(0,y.Z)(Ga,2),Ya=aa[0],ta=aa[1],Ha=m.useState(),na=(0,y.Z)(Ha,2),Qa=na[0],ra=na[1],Xa=m.useState(!1),sa=(0,y.Z)(Xa,2),qa=sa[0],Ie=sa[1],_a=m.useState("Property"),ia=(0,y.Z)(_a,2),et=ia[0],at=ia[1],tt=m.useState(!1),la=(0,y.Z)(tt,2),nt=la[0],ua=la[1],rt=m.useState([]),oa=(0,y.Z)(rt,2),da=oa[0],st=oa[1],it=m.useState(),ca=(0,y.Z)(it,2),he=ca[0],lt=ca[1],ut=m.useState(),va=(0,y.Z)(ut,2),ot=va[0],dt=va[1],ct=m.useState(""),fa=(0,y.Z)(ct,2),vt=fa[0],ft=fa[1],ht=m.useState(),ha=(0,y.Z)(ht,2),pa=ha[0],pt=ha[1],mt=ze.Z.useForm(),gt=(0,y.Z)(mt,1),pe=gt[0],yt=m.useState(!1),ma=(0,y.Z)(yt,2),St=ma[0],Be=ma[1],ga=function(){var d=(0,F.Z)(p().mark(function r(t){var c,n,S,i,L=arguments;return p().wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return c=L.length>1&&L[1]!==void 0?L[1]:!1,g.next=3,(0,X.MI)(t.activities,t.connections);case 3:n=g.sent,c?(S=new Ea.Vq({type:"dagre",rankdir:"TB",nodesep:60,ranksep:40}),i=S.layout(n),ta(i)):ta(n);case 5:case"end":return g.stop()}},r)}));return function(t){return d.apply(this,arguments)}}(),xt=function(){var d=(0,F.Z)(p().mark(function r(){var t,c,n;return p().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(h){i.next=2;break}return i.abrupt("return");case 2:return i.next=4,(t=K.current)===null||t===void 0?void 0:t.getGraphData();case 4:c=i.sent,c?(n=(0,X.me)(c),(0,Ra.RY)("".concat(h.name,"-").concat(b,".json"),JSON.stringify((0,j.Z)((0,j.Z)({},n),{},{name:h.name,displayName:h.displayName,version:b})))):Q.default.error("Get graph data failed");case 6:case"end":return i.stop()}},r)}));return function(){return d.apply(this,arguments)}}(),Zt=function(){var d=(0,F.Z)(p().mark(function r(t){var c,n,S,i;return p().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,t.text();case 3:return c=o.sent,n=JSON.parse(c),S={connections:[],activities:n.activities},n!=null&&n.connections&&(S.connections=(i=n.connections)===null||i===void 0?void 0:i.map(function(g){var w,E;return{sourceId:(w=g.sourceId)!==null&&w!==void 0?w:g.sourceActivityId,targetId:(E=g.targetId)!==null&&E!==void 0?E:g.targetActivityId,outcome:g.outcome}})),o.next=9,ga(S,!0);case 9:Q.default.info("import successful."),o.next=16;break;case 12:o.prev=12,o.t0=o.catch(0),console.error(o.t0),Q.default.error("Import file failed");case 16:case"end":return o.stop()}},r,null,[[0,12]])}));return function(t){return d.apply(this,arguments)}}(),$t=function(){var d=(0,F.Z)(p().mark(function r(t,c){var n,S,i,L,o,g,w,E,Z,J,k,ue,oe;return p().wrap(function(G){for(;;)switch(G.prev=G.next){case 0:return w=Q.default.loading("Loading...."),at("Properties - ".concat(t.displayName," (").concat(t.type,")")),ft(c.id),G.next=5,(0,X.Qr)();case 5:if(E=G.sent,Z=(n=E.items)===null||n===void 0?void 0:n.find(function($){return $.type==t.type}),Z){G.next=10;break}return Q.default.error("The node type '".concat(t.type,"' not found.")),G.abrupt("return");case 10:J=((S=Z.inputProperties)!==null&&S!==void 0?S:[]).filter(function($){return $.isBrowsable}).map(function($){return(0,j.Z)((0,j.Z)({},$),{},{isRequired:$.isDesignerCritical})}),st(J??[]),k={name:(i=c.getProp("name"))!==null&&i!==void 0?i:"",displayName:(L=c.getProp("displayName"))!==null&&L!==void 0?L:"",description:(o=c.getProp("description"))!==null&&o!==void 0?o:"",props:{}},lt(Z),ue={},J==null||J.forEach(function($){var Y,M=(0,X.Oq)($);ue[$.name]=M.supports;var q=M.default,C=(Y=$.defaultValue)!==null&&Y!==void 0?Y:void 0,T="";C&&(typeof C=="object"?T=JSON.stringify(C):C?T=C==null?void 0:C.toString():T=""),q&&(k.props[$.name]={syntax:"Default",value:C,expressions:(0,Le.Z)({Default:C},q,T)}),M.editor&&(k.props[$.name]={syntax:M.editor,value:C,expressions:{Literal:T}})}),dt(ue),oe=(g=c.getProp("properties"))!==null&&g!==void 0?g:[],console.debug("sourceProperties: ",oe),oe.forEach(function($){var Y,M=$.syntax?$.syntax:"Default",q=void 0,C="",T="";if(Object.keys((Y=$.expressions)!==null&&Y!==void 0?Y:{}).filter(function(me){return me!="$id"}).length>0){var de;T=Object.keys((de=$.expressions)!==null&&de!==void 0?de:{}).filter(function(me){return me!="$id"})[0],C=$.expressions[T]}if(M=="Default"){var _,ie=(_=Z.inputProperties)===null||_===void 0?void 0:_.find(function(me){return me.name==$.name});q=C,((ie==null?void 0:ie.uiHint)=="check-list"||(ie==null?void 0:ie.uiHint)=="multi-text")&&(C.startsWith("{")&&C.endsWith("}")||C.startsWith("[")&&C.endsWith("]"))&&(q=JSON.parse(C))}k.props[$.name]=(0,j.Z)((0,j.Z)({},k.props[$.name]),{},{syntax:M,expressions:(0,Le.Z)({Default:q},T,C)})}),pt(k),console.debug("load form data: ",k),pe.resetFields(),pe.setFieldsValue(k),ua(!0),w();case 26:case"end":return G.stop()}},r)}));return function(t,c){return d.apply(this,arguments)}}(),jt=function(){var d=(0,F.Z)(p().mark(function r(t){var c,n,S,i,L,o,g,w,E,Z,J,k,ue,oe,De,G,$,Y,M,q,C,T,de,_,ie;return p().wrap(function(Ke){for(;;)switch(Ke.prev=Ke.next){case 0:if(console.debug("save form data: ",t),S={name:t.name,displayName:t.displayName,description:t.description,properties:[],outcomes:[]},t.props)for(i in(L=t.props)!==null&&L!==void 0?L:{})g=t.props[i],w=g.syntax,E=void 0,Z="",J=(o=g.expressions)!==null&&o!==void 0?o:{},k=ot[i],g.expressions&&Object.keys(J).length>0&&(g.syntax=="Default"&&k.length>0?(w=k[0],E=(ue=(oe=g.expressions)===null||oe===void 0?void 0:oe[g.syntax])!==null&&ue!==void 0?ue:void 0):E=(De=(G=g.expressions)===null||G===void 0?void 0:G[w])!==null&&De!==void 0?De:void 0,Object.keys(J).indexOf(g.syntax)==-1&&(w=Object.keys(J)[0],E=($=(Y=g.expressions)===null||Y===void 0?void 0:Y[w])!==null&&$!==void 0?$:void 0),E&&(typeof E=="object"?Z=JSON.stringify(E):typeof E!="string"?Z=E.toString():Z=E),S.properties.push({name:i,syntax:g.syntax=="Default"?void 0:g.syntax==w?w:void 0,expressions:(0,Le.Z)({},w,Z),value:E}));M=(c=he==null?void 0:he.outcomes)!==null&&c!==void 0?c:[],q=da.find(function(ce){return ce.considerValuesAsOutcomes}),q&&(T=(C=S.properties.find(function(ce){return ce.name==q.name}))===null||C===void 0?void 0:C.value,T&&((0,Oa.isArray)(T)?M.push.apply(M,(0,Re.Z)(T)):typeof T=="string"&&T.startsWith("[")&&T.endsWith("]")&&M.push.apply(M,(0,Re.Z)(JSON.parse(T))))),(he==null?void 0:he.type)=="Switch"&&(_=(de=S.properties.find(function(ce){return ce.name=="Cases"}))===null||de===void 0?void 0:de.value,_&&typeof _=="string"&&_.startsWith("[")&&_.endsWith("]")&&(ie=JSON.parse(_).map(function(ce){return ce.name}),M.push.apply(M,(0,Re.Z)(ie)))),S.outcomes=M,console.debug("updated node: ",S),(n=K.current)===null||n===void 0||n.updateNodeProperties(vt,S);case 10:case"end":return Ke.stop()}},r)}));return function(t){return d.apply(this,arguments)}}(),ya=function(){var d=(0,F.Z)(p().mark(function r(){var t,c,n,S,i,L,o,g,w=arguments;return p().wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return c=w.length>0&&w[0]!==void 0?w[0]:!1,l(!0),Z.next=4,(t=K.current)===null||t===void 0?void 0:t.getGraphData();case 4:if(n=Z.sent,(n==null?void 0:n.nodes.length)!=0){Z.next=9;break}return Q.default.error("No nodes in the graph"),l(!1),Z.abrupt("return");case 9:if(S=(0,X.me)(n),i=S.activities,L=S.connections,o=null,!s){Z.next=17;break}return Z.next=14,(0,Se.qr)(s,{definition:h,activities:i,connections:L,isPublished:c});case 14:o=Z.sent,Z.next=20;break;case 17:return Z.next=19,(0,Se.$u)({definition:h,activities:i,connections:L,isPublished:c});case 19:o=Z.sent;case 20:o&&(c?Q.default.success("Publish workflow success. version: "+o.version):Q.default.success("Save draft successed. version: "+o.version),s||le.replace("/designer?id=".concat((g=o.definition)===null||g===void 0?void 0:g.id)),x(o.definition.id),u(o.version),R(o),fe(o.definition)),l(!1);case 22:case"end":return Z.stop()}},r)}));return function(){return d.apply(this,arguments)}}(),bt=function(){ra("Create"),Ie(!0)},Sa=function(){var d=(0,F.Z)(p().mark(function r(t,c){var n;return p().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(I(!0),!c){i.next=7;break}return i.next=4,(0,Se.lE)(t,c);case 4:n=i.sent,i.next=10;break;case 7:return i.next=9,(0,Se.kW)(t);case 9:n=i.sent;case 10:if(I(!1),!n){i.next=19;break}return R(n),fe(n.definition),u(n.version),i.next=17,ga(n);case 17:i.next=20;break;case 19:le.goBack();case 20:case"end":return i.stop()}},r)}));return function(t,c){return d.apply(this,arguments)}}();return(0,m.useEffect)(function(){var d,r,t=(d=(r=A.query)===null||r===void 0?void 0:r.id)!==null&&d!==void 0?d:"";x(t),t?Sa(t):bt()},[]),(0,e.jsxs)(Da.ZP,{children:[(0,e.jsx)(ge.Z,{onKeyDown:function(r){r.preventDefault();var t=String.fromCharCode(r.which).toLowerCase();(r.ctrlKey||r.metaKey)&&t==="s"&&console.log("ctrl+s")},children:(0,e.jsxs)(Oe.Z,{spinning:ne,children:[(0,e.jsxs)(ve.Z,{style:{marginBottom:15},children:[(0,e.jsx)(ae.Z,{flex:1,className:"title-bar",children:(0,e.jsxs)(ja.Z.Text,{children:[h==null?void 0:h.name," ",(0,e.jsxs)(ke.Z,{children:["Draft :",(v=h==null?void 0:h.latestVersion)!==null&&v!==void 0?v:1]}),(h==null?void 0:h.publishedVersion)&&(0,e.jsxs)(ke.Z,{children:[" Published :",h==null?void 0:h.publishedVersion]})]})}),(0,e.jsxs)(ae.Z,{children:[(0,e.jsx)(Ve.Z,{type:"default",disabled:!(h!=null&&h.name),loading:U,style:{marginLeft:10},icon:(0,e.jsx)(Ca.Z,{}),onClick:(0,F.Z)(p().mark(function d(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ya();case 2:case"end":return t.stop()}},d)})),children:"Save"}),(0,e.jsx)(Ve.Z,{type:"default",disabled:!(h!=null&&h.name),loading:U,style:{marginLeft:10},icon:(0,e.jsx)(Pa.Z,{}),onClick:(0,F.Z)(p().mark(function d(){return p().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ya(!0);case 2:case"end":return t.stop()}},d)})),children:"Publish"}),(0,e.jsx)(Te.Z.Button,{disabled:U||!(h!=null&&h.name),style:{marginLeft:10},onClick:function(){ra("Edit"),Ie(!0)},overlay:(0,e.jsxs)(H.Z,{children:[(0,e.jsx)(H.Z.Item,{onClick:function(){Be(!0)},disabled:!s,children:"Versions"},"1"),(0,e.jsx)(H.Z.Divider,{}),(0,e.jsx)(H.Z.Item,{onClick:function(){xt()},children:"Export"},"2"),(0,e.jsx)(H.Z.Item,{children:(0,e.jsx)(Fe.Z,{accept:".json",showUploadList:!1,beforeUpload:function(r){return Zt(r),!1},children:"Import"})},"3")]}),children:"Settings"})]})]}),(0,e.jsx)(Fa.Z,{actionRef:K,graphData:Ya,onNodeDoubleClick:$t,height:800})]})}),(0,e.jsx)(Ne.Y,{layout:"horizontal",preserve:!1,labelCol:{span:5},width:600,labelWrap:!0,title:Qa,visible:qa,initialValues:h,onVisibleChange:Ie,onFinish:function(){var d=(0,F.Z)(p().mark(function r(t){return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return fe((0,j.Z)((0,j.Z)({},h),t)),n.abrupt("return",!0);case 2:case"end":return n.stop()}},r)}));return function(r){return d.apply(this,arguments)}}(),children:(0,e.jsx)(Ta.Z,{})}),(0,e.jsx)(Ne.Y,{form:pe,layout:"horizontal",modalProps:{maskClosable:!1,destroyOnClose:!0},preserve:!1,labelWrap:!0,title:et,labelCol:{span:5},grid:!0,width:800,initialValues:pa,visible:nt,scrollToFirstError:!0,onVisibleChange:ua,onFinish:function(){var d=(0,F.Z)(p().mark(function r(t){return p().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return jt((0,j.Z)((0,j.Z)({},pa),t)),n.abrupt("return",!0);case 2:case"end":return n.stop()}},r)}));return function(r){return d.apply(this,arguments)}}(),children:(0,e.jsx)(Ua,{workflowDefinitionId:s,properties:da,getFieldValue:pe.getFieldValue,setFieldsValue:pe.setFieldsValue,setFieldValue:function(r,t){pe.setFields([{name:r,value:t}])}})}),(0,e.jsx)(we.Z,{title:"Version History",destroyOnClose:!0,visible:St,onCancel:function(){return Be(!1)},width:650,onOk:function(){_e?(Be(!1),Q.default.loading("Loading...",1),Sa(s,_e)):Q.default.error("Please select a version")},children:(0,e.jsx)(wa.ZP,{search:!1,toolBarRender:!1,rowKey:"version",columns:[{title:"Version",dataIndex:"version"},{title:"Latest",dataIndex:"isLatest",align:"center",valueEnum:{true:{text:"Y"},false:{text:"-"}}},{title:"Published",dataIndex:"isPublished",align:"center",valueEnum:{true:{text:"Y"},false:{text:"-"}}},{title:"Modification Time",dataIndex:"creationTime",valueType:"dateTime",width:160,align:"center",renderText:function(r,t){var c;return(c=t.lastModificationTime)!==null&&c!==void 0?c:t.creationTime}}],rowSelection:{type:"radio",alwaysShowAlert:!1,onChange:function(r){if(r.length>0){var t=parseInt(r[0].toString());ea(t)}}},tableAlertRender:!1,pagination:{pageSize:10},request:function(){var d=(0,F.Z)(p().mark(function r(t){var c,n,S,i;return p().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return c=t.current,n=t.pageSize,delete t.current,delete t.pageSize,S=(c-1)*n,o.next=6,(0,Se.DY)(s,{skipCount:S,maxResultCount:n});case 6:if(i=o.sent,!i){o.next=12;break}return ea(void 0),o.abrupt("return",{success:!0,data:i.items,total:i.totalCount});case 12:return o.abrupt("return",{success:!1});case 13:case"end":return o.stop()}},r)}));return function(r){return d.apply(this,arguments)}}()})})]})},ka=Ja}}]);
