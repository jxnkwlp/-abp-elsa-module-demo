(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[853],{35991:function(Ra,fe,n){"use strict";n.d(fe,{Z:function(){return Le}});var Ke=n(2824),me;(function(e){e[e.Action=1]="Action",e[e.Trigger=2]="Trigger",e[e.Job=4]="Job"})(me||(me={}));var $e;(function(e){e[e.Standard=1]="Standard",e[e.VarArgs=2]="VarArgs",e[e.Any=3]="Any",e[e.HasThis=32]="HasThis",e[e.ExplicitThis=64]="ExplicitThis"})($e||($e={}));var ge;(function(e){e[e.None=0]="None",e[e.SpecialName=512]="SpecialName",e[e.RTSpecialName=1024]="RTSpecialName"})(ge||(ge={}));var Ne;(function(e){e[e.PrivateScope=0]="PrivateScope",e[e.Private=1]="Private",e[e.FamANDAssem=2]="FamANDAssem",e[e.Assembly=3]="Assembly",e[e.Family=4]="Family",e[e.FamORAssem=5]="FamORAssem",e[e.Public=6]="Public",e[e.FieldAccessMask=7]="FieldAccessMask",e[e.Static=16]="Static",e[e.InitOnly=32]="InitOnly",e[e.Literal=64]="Literal",e[e.NotSerialized=128]="NotSerialized",e[e.HasFieldRVA=256]="HasFieldRVA",e[e.SpecialName=512]="SpecialName",e[e.RTSpecialName=1024]="RTSpecialName",e[e.HasFieldMarshal=4096]="HasFieldMarshal",e[e.PinvokeImpl=8192]="PinvokeImpl",e[e.HasDefault=32768]="HasDefault",e[e.ReservedMask=38144]="ReservedMask"})(Ne||(Ne={}));var Se;(function(e){e[e.None=0]="None",e[e.Covariant=1]="Covariant",e[e.Contravariant=2]="Contravariant",e[e.VarianceMask=3]="VarianceMask",e[e.ReferenceTypeConstraint=4]="ReferenceTypeConstraint",e[e.NotNullableValueTypeConstraint=8]="NotNullableValueTypeConstraint",e[e.DefaultConstructorConstraint=16]="DefaultConstructorConstraint",e[e.SpecialConstraintMask=28]="SpecialConstraintMask"})(Se||(Se={}));var je;(function(e){e[e.Sequential=0]="Sequential",e[e.Explicit=2]="Explicit",e[e.Auto=3]="Auto"})(je||(je={}));var ie;(function(e){e[e.Constructor=1]="Constructor",e[e.Event=2]="Event",e[e.Field=4]="Field",e[e.Method=8]="Method",e[e.Property=16]="Property",e[e.TypeInfo=32]="TypeInfo",e[e.Custom=64]="Custom",e[e.NestedType=128]="NestedType",e[e.All=191]="All"})(ie||(ie={}));var Ce;(function(e){e[e.ReuseSlot=0]="ReuseSlot",e[e.PrivateScope=1]="PrivateScope",e[e.Private=2]="Private",e[e.FamANDAssem=3]="FamANDAssem",e[e.Assembly=4]="Assembly",e[e.Family=5]="Family",e[e.FamORAssem=6]="FamORAssem",e[e.Public=7]="Public",e[e.MemberAccessMask=8]="MemberAccessMask",e[e.UnmanagedExport=16]="UnmanagedExport",e[e.Static=32]="Static",e[e.Final=64]="Final",e[e.Virtual=128]="Virtual",e[e.HideBySig=256]="HideBySig",e[e.NewSlot=512]="NewSlot",e[e.VtableLayoutMask=1024]="VtableLayoutMask",e[e.CheckAccessOnOverride=2048]="CheckAccessOnOverride",e[e.Abstract=4096]="Abstract",e[e.SpecialName=8192]="SpecialName",e[e.RTSpecialName=16384]="RTSpecialName",e[e.PinvokeImpl=32768]="PinvokeImpl",e[e.HasSecurity=53248]="HasSecurity"})(Ce||(Ce={}));var he;(function(e){e[e.IL=0]="IL",e[e.Managed=1]="Managed",e[e.Native=2]="Native",e[e.OPTIL=3]="OPTIL",e[e.Runtime=4]="Runtime",e[e.CodeTypeMask=8]="CodeTypeMask",e[e.Unmanaged=16]="Unmanaged",e[e.ManagedMask=32]="ManagedMask",e[e.NoInlining=64]="NoInlining",e[e.ForwardRef=128]="ForwardRef",e[e.Synchronized=256]="Synchronized",e[e.NoOptimization=512]="NoOptimization",e[e.PreserveSig=4096]="PreserveSig",e[e.AggressiveInlining=65535]="AggressiveInlining"})(he||(he={}));var Oe;(function(e){e[e.None=0]="None",e[e.In=1]="In",e[e.Out=2]="Out",e[e.Lcid=4]="Lcid",e[e.Retval=8]="Retval",e[e.Optional=16]="Optional",e[e.HasDefault=4096]="HasDefault",e[e.HasFieldMarshal=8192]="HasFieldMarshal",e[e.Reserved3=16384]="Reserved3",e[e.Reserved4=32768]="Reserved4",e[e.ReservedMask=61440]="ReservedMask"})(Oe||(Oe={}));var pe;(function(e){e[e.None=0]="None",e[e.SpecialName=512]="SpecialName",e[e.RTSpecialName=1024]="RTSpecialName",e[e.HasDefault=4096]="HasDefault",e[e.Reserved2=8192]="Reserved2",e[e.Reserved3=16384]="Reserved3",e[e.Reserved4=32768]="Reserved4",e[e.ReservedMask=62464]="ReservedMask"})(pe||(pe={}));var Ve;(function(e){e[e.None=0]="None",e[e.Level1=1]="Level1",e[e.Level2=2]="Level2"})(Ve||(Ve={}));var ae;(function(e){e[e.NotPublic=0]="NotPublic",e[e.AutoLayout=1]="AutoLayout",e[e.AnsiClass=2]="AnsiClass",e[e.Class=3]="Class",e[e.Public=4]="Public",e[e.NestedPublic=5]="NestedPublic",e[e.NestedPrivate=6]="NestedPrivate",e[e.NestedFamily=7]="NestedFamily",e[e.NestedAssembly=8]="NestedAssembly",e[e.NestedFamANDAssem=16]="NestedFamANDAssem",e[e.NestedFamORAssem=24]="NestedFamORAssem",e[e.VisibilityMask=32]="VisibilityMask",e[e.SequentialLayout=128]="SequentialLayout",e[e.ExplicitLayout=256]="ExplicitLayout",e[e.LayoutMask=1024]="LayoutMask",e[e.Interface=2048]="Interface",e[e.ClassSemanticsMask=4096]="ClassSemanticsMask",e[e.Abstract=8192]="Abstract",e[e.Sealed=16384]="Sealed",e[e.SpecialName=65536]="SpecialName",e[e.RTSpecialName=131072]="RTSpecialName",e[e.Import=196608]="Import",e[e.Serializable=262144]="Serializable",e[e.WindowsRuntime=264192]="WindowsRuntime",e[e.UnicodeClass=1048576]="UnicodeClass",e[e.AutoClass=12582912]="AutoClass"})(ae||(ae={}));var De;(function(e){e[e.Burst=0]="Burst",e[e.Activity=1]="Activity"})(De||(De={}));var ne;(function(e){e[e.Suspended=0]="Suspended",e[e.WorkflowBurst=1]="WorkflowBurst",e[e.ActivityExecuted=2]="ActivityExecuted"})(ne||(ne={}));var Ee;(function(e){e[e.Idle=0]="Idle",e[e.Running=1]="Running",e[e.Finished=2]="Finished",e[e.Suspended=3]="Suspended",e[e.Faulted=4]="Faulted",e[e.Cancelled=5]="Cancelled"})(Ee||(Ee={}));var Y=n(5966),Qe=n(90672),Fe=n(52688),We=n(64317),W=n(85893),Xe=function(){return(0,W.jsxs)(W.Fragment,{children:[(0,W.jsx)(Y.Z,{label:"Name",name:"name",rules:[{required:!0},{max:16}]}),(0,W.jsx)(Y.Z,{label:"Display Name",name:"displayName",rules:[{required:!0},{max:16}]}),(0,W.jsx)(Qe.Z,{label:"Description",name:"description",fieldProps:{rows:2,autoSize:{minRows:2,maxRows:5}},rules:[{max:64}]}),(0,W.jsx)(Fe.Z,{label:"Singleton",name:"isSingleton"}),(0,W.jsx)(Y.Z,{label:"Tag",name:"tag"}),(0,W.jsx)(We.Z,{label:"Persistence Behavior",name:"persistenceBehavior",options:Object.entries(ne).map(function(ce){var we=(0,Ke.Z)(ce,2),I=we[0],y=we[1];return{label:y,value:I}}),initialValue:ne.WorkflowBurst})]})},Le=Xe},39285:function(Ra,fe,n){"use strict";n.r(fe),n.d(fe,{default:function(){return Ka}});var Ke=n(71194),me=n(50146),$e=n(58024),ge=n(39144),Ne=n(20228),Se=n(11382),je=n(13062),ie=n(71230),Ce=n(59250),he=n(13013),Oe=n(43185),pe=n(94412),Ve=n(30887),ae=n(54689),De=n(57663),ne=n(71577),Ee=n(89032),Y=n(15746),Qe=n(402),Fe=n(61859),We=n(71153),W=n(60331),Xe=n(22385),Le=n(61580),e=n(86582),ce=n(32059),we=n(34792),I=n(48086),y=n(11849),L=n(3182),Rn=n(9715),Ge=n(92080),h=n(2824),ya=n(94043),m=n.n(ya),$a=n(64322),te=n(41180),Na=n(92104),ja=n(24557),Pe=n(37476),Ca=n(67265),Oa=n(10926),Va=n(26155),Da=n(96486),g=n(67294),qe=n(51615),Ea=n(35991),Fa=n(71536),yn=n(18106),ze=n(16004),He=n(952),La=n(63434),wa=n(52688),xe=n(64317),Me=n(90672),Ze=n(5966),be=n(24739),Ae=n(97462),Pa=n(59962),M=n(87831),za=n(62602),ve=n(26565),Ha=n(81493),a=n(85893),ka=function(f){var z=g.createRef(),X=g.useState(f.value||""),b=(0,h.Z)(X,1),U=b[0],le=g.useState(!1),A=(0,h.Z)(le,2),G=A[0],_=A[1],B=g.useState(),u=(0,h.Z)(B,2),H=u[0],O=u[1],c=g.useState(),V=(0,h.Z)(c,2),E=V[0],k=V[1],D=function($){var Z;f==null||(Z=f.onChange)===null||Z===void 0||Z.call(f,$)},v=function(){G?(_(!1),k(H)):(_(!0),k({w:document.body.clientWidth,h:document.body.clientHeight}))},J=function(){var j=(0,L.Z)(m().mark(function $(){var Z;return m().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(!f.getJavaScriptLibs){S.next=5;break}return S.next=3,f.getJavaScriptLibs();case 3:Z=S.sent,(Z==null?void 0:Z.length)>0&&(ve.languages.typescript.javascriptDefaults.setExtraLibs(Z??[]),Z.forEach(function(re){var Re=ve.editor.getModel(ve.Uri.parse(re.filePath));Re&&Re.dispose(),ve.editor.createModel(re.content,"typescript",ve.Uri.parse(re.filePath))}));case 5:case"end":return S.stop()}},$)}));return function(){return j.apply(this,arguments)}}();return(0,g.useEffect)(function(){var j,$;O({w:f.width,h:(j=f.height)!==null&&j!==void 0?j:150}),k({w:f.width,h:($=f.height)!==null&&$!==void 0?$:150})},[0]),(0,g.useEffect)(function(){f.language=="javascript"&&J()},[f.language]),(0,a.jsxs)("div",{className:G?"monaco-editor-container fullscreen":"monaco-editor-container",id:f.id,style:{width:E==null?void 0:E.w,height:E==null?void 0:E.h},children:[(0,a.jsx)(Ha.ZP,{ref:z,language:f.language,onChange:function($){D($)},options:(0,y.Z)({minimap:{enabled:G},wordWrap:"bounded",wordWrapColumn:1024,automaticLayout:!0,autoIndent:"full",tabSize:2,autoClosingBrackets:"languageDefined",foldingStrategy:"auto"},f==null?void 0:f.options),editorDidMount:function($){$.setValue(U)}}),(0,a.jsx)("div",{className:"fullscreen-toggle",children:(0,a.jsx)("a",{onClick:function(){return v()},title:"Toggle fullscreen",children:(0,a.jsx)(za.Z,{})})})]})},_e=ka,Ja=function(f){var z,X=g.useState([]),b=(0,h.Z)(X,2),U=b[0],le=b[1],A=g.useState(!1),G=(0,h.Z)(A,2),_=G[0],B=G[1],u=g.useState((z=f==null?void 0:f.title)!==null&&z!==void 0?z:"Cases Edit"),H=(0,h.Z)(u,2),O=H[0],c=H[1],V=Ge.Z.useForm(),E=(0,h.Z)(V,1),k=E[0];return(0,g.useEffect)(function(){var D;le(JSON.parse((D=f==null?void 0:f.value)!==null&&D!==void 0?D:"[]"))},[k,f]),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(ie.Z,{children:[(0,a.jsx)(Y.Z,{flex:1,children:(0,a.jsx)("div",{style:{wordBreak:"break-all"},children:JSON.stringify(U??[])})}),(0,a.jsx)(Y.Z,{children:(0,a.jsx)(ne.Z,{type:"default",onClick:function(){B(!0),k.setFieldsValue({input:U})},children:"Configure"})})]}),(0,a.jsx)(Pe.Y,{form:k,title:O,width:680,layout:"horizontal",labelCol:{span:4},modalProps:{destroyOnClose:!0,maskClosable:!1},visible:_,onVisibleChange:B,initialValues:U,onFinish:function(){var D=(0,L.Z)(m().mark(function v(J){var j,$,Z;return m().wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return le((j=J==null?void 0:J.input)!==null&&j!==void 0?j:[]),($=f.onChange)===null||$===void 0||$.call(f,JSON.stringify((Z=J==null?void 0:J.input)!==null&&Z!==void 0?Z:[])),S.abrupt("return",!0);case 3:case"end":return S.stop()}},v)}));return function(v){return D.apply(this,arguments)}}(),grid:!0,children:(0,a.jsx)(Pa.u,{name:"input",itemContainerRender:function(v){return(0,a.jsx)(be.UW,{children:v})},min:1,actionGuard:{beforeAddRow:function(v){return v={syntax:"JavaScript"},!0}},children:function(v,J,j){return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Ze.Z,{name:["name"],label:"Name",placeholder:"Name",rules:[{required:!0},{max:64}],colProps:{span:16}}),(0,a.jsx)(xe.Z,{name:["syntax"],label:"Syntax",options:[{label:"JavaScript",value:"JavaScript"},{label:"Liquid",value:"Liquid"}],rules:[{required:!0}],allowClear:!1,colProps:{span:8}}),(0,a.jsxs)(Y.Z,{span:24,children:[(0,a.jsx)(Ae.Z,{name:["syntax"],children:function(Z){var T=Z.syntax;return T?(0,a.jsx)(He.ZP.Item,{name:["expressions",T],rules:[{required:!0,message:"Required"}],children:(0,a.jsx)(_e,{height:150,language:(0,M.dv)(T)})}):(0,a.jsx)("span",{})}}),(0,a.jsx)("div",{style:{borderBottom:"1px #eee solid",height:"1px",marginBottom:"15px"},className:"ant-col ant-col-24"})]})]})}})})]})},Ia=Ja,ke=20,Ua=4,Ba=function(f){var z=f.properties,X=g.useState("1"),b=(0,h.Z)(X,2),U=b[0],le=b[1];(0,g.useEffect)(function(){z.length>0&&le("2")},[]);var A=function(){var B=(0,L.Z)(m().mark(function u(){var H;return m().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(f.workflowDefinitionId){c.next=2;break}return c.abrupt("return","");case 2:return c.next=4,(0,M.tm)(f.workflowDefinitionId);case 4:return H=c.sent,c.abrupt("return",H);case 6:case"end":return c.stop()}},u)}));return function(){return B.apply(this,arguments)}}(),G=function(u,H,O,c,V,E){if(O=="JavaScript"||O=="Liquid"||O=="Json")return(0,a.jsx)(Y.Z,{span:ke,children:(0,a.jsx)(He.ZP.Item,{label:V.label,name:u,required:c.isRequired,extra:c.hint,rules:[{required:c.isRequired}],children:(0,a.jsx)(_e,{height:150,language:(0,M.dv)(O),getJavaScriptLibs:(0,L.Z)(m().mark(function k(){return m().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(O.toLocaleLowerCase()!="javascript"){v.next=6;break}return v.next=3,A();case 3:return v.t0=v.sent,v.t1={content:v.t0,filePath:"script.d.ts"},v.abrupt("return",[v.t1]);case 6:return v.abrupt("return",[]);case 7:case"end":return v.stop()}},k)}))})})});if(O=="Switch")return(0,a.jsx)(Y.Z,{span:ke,children:(0,a.jsx)(He.ZP.Item,{label:V.label,name:u,required:c.isRequired,extra:c.hint,rules:[{required:c.isRequired}],children:(0,a.jsx)(Ia,{})})});switch(c.uiHint){case"check-list":return(0,a.jsx)(La.Z.Group,(0,y.Z)((0,y.Z)({},V),{},{name:u,options:E,extra:c.hint,rules:[{required:c.isRequired}]}));case"checkbox":return(0,a.jsx)(wa.Z,(0,y.Z)((0,y.Z)({},V),{},{name:u,extra:c.hint,rules:[{required:c.isRequired}]}));case"dropdown":return(0,a.jsx)(xe.Z,(0,y.Z)((0,y.Z)({},V),{},{name:u,options:E,rules:[{required:c.isRequired}]}));case"multi-text":return(0,a.jsx)(xe.Z,(0,y.Z)((0,y.Z)({},V),{},{name:u,options:E,fieldProps:{mode:"tags"},rules:[{required:c.isRequired}]}));case"multi-line":case"code-editor":return(0,a.jsx)(Me.Z,(0,y.Z)((0,y.Z)({},V),{},{name:u,fieldProps:{rows:2,autoSize:{minRows:2,maxRows:10},showCount:!1},rules:[{required:c.isRequired}]}));default:return(0,a.jsx)(Ze.Z,(0,y.Z)((0,y.Z)({},V),{},{name:u,rules:[{required:c.isRequired}]}))}},_=function(){return(z??[]).map(function(u){var H,O,c=Array.isArray(u.options)?u.options.map(function(v){return{label:v.text,value:v.value}}):Array.isArray((H=u.options)===null||H===void 0?void 0:H.items)?(O=u.options)===null||O===void 0?void 0:O.items.map(function(v){return{label:v.text,value:v.value}}):null,V={label:u.label,readOnly:u.isReadOnly,placeholder:u.hint,colProps:{span:ke},required:u.isRequired},E=(0,M.Oq)(u),k=E.defaultSyntax,D=E.syntaxes;return(0,a.jsxs)(be.UW,{children:[(0,a.jsx)(Ae.Z,{name:["name",["props",u.name,"syntax"]],children:function(J){var j,$,Z=J.props,T=(j=Z==null||($=Z[u.name])===null||$===void 0?void 0:$.syntax)!==null&&j!==void 0?j:k;return G(["props",u.name,"expressions",T],u.defaultValue,T,u,V,c)}}),(0,a.jsx)(xe.Z,{name:["props",u.name,"syntax"],options:D.map(function(v){return{label:v,value:v}}),allowClear:!1,colProps:{span:Ua}})]},u.name)})};return(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)(ze.Z,{defaultActiveKey:U,type:"line",style:{width:"100%",flex:1},children:[z.length>0&&(0,a.jsx)(ze.Z.TabPane,{tab:"Properties",children:(0,a.jsx)(ie.Z,{children:_()})},"1"),(0,a.jsx)(ze.Z.TabPane,{tab:"Common",children:(0,a.jsxs)(ie.Z,{children:[(0,a.jsx)(Ze.Z,{label:"Name",name:"name",rules:[{required:!0},{max:32}]}),(0,a.jsx)(Ze.Z,{label:"Display Name",name:"displayName",rules:[{required:!1},{max:32}]}),(0,a.jsx)(Me.Z,{label:"Description",name:"description",rules:[{max:128}],fieldProps:{autoSize:{minRows:2,maxRows:10}}})]})},"2")]})})},Ya=Ba,Ta=function(){var f=(0,qe.TH)(),z=(0,qe.k6)(),X=(0,g.useRef)(),b=g.useState(!1),U=(0,h.Z)(b,2),le=U[0],A=U[1],G=g.useState(!1),_=(0,h.Z)(G,2),B=_[0],u=_[1],H=g.useState(),O=(0,h.Z)(H,2),c=O[0],V=O[1],E=g.useState(1),k=(0,h.Z)(E,2),D=k[0],v=k[1],J=g.useState(),j=(0,h.Z)(J,2),$=j[1],Z=g.useState(),T=(0,h.Z)(Z,2),S=T[0],re=T[1],Re=g.useState(),ea=(0,h.Z)(Re,2),aa=ea[0],na=ea[1],Qa=g.useState(),la=(0,h.Z)(Qa,2),Wa=la[0],sa=la[1],Xa=g.useState(),ia=(0,h.Z)(Xa,2),Ga=ia[0],ra=ia[1],qa=g.useState(!1),oa=(0,h.Z)(qa,2),Ma=oa[0],Ie=oa[1],ba=g.useState("Property"),da=(0,h.Z)(ba,2),Aa=da[0],_a=da[1],en=g.useState(!1),ua=(0,h.Z)(en,2),an=ua[0],ca=ua[1],nn=g.useState([]),ta=(0,h.Z)(nn,2),va=ta[0],ln=ta[1],sn=g.useState(),fa=(0,h.Z)(sn,2),Ue=fa[0],rn=fa[1],on=g.useState(""),ma=(0,h.Z)(on,2),dn=ma[0],un=ma[1],cn=g.useState(),ga=(0,h.Z)(cn,2),Sa=ga[0],tn=ga[1],vn=Ge.Z.useForm(),fn=(0,h.Z)(vn,1),oe=fn[0],mn=g.useState(!1),ha=(0,h.Z)(mn,2),gn=ha[0],Be=ha[1],pa=function(){var d=(0,L.Z)(m().mark(function i(l){var t,s,x,r,F=arguments;return m().wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return t=F.length>1&&F[1]!==void 0?F[1]:!1,N.next=3,(0,M.MI)(l.activities,l.connections);case 3:s=N.sent,t?(x=new Va.Vq({type:"dagre",rankdir:"TB",nodesep:60,ranksep:40}),r=x.layout(s),sa(r)):sa(s);case 5:case"end":return N.stop()}},i)}));return function(l){return d.apply(this,arguments)}}(),Sn=function(){var d=(0,L.Z)(m().mark(function i(){var l,t,s;return m().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(S){r.next=2;break}return r.abrupt("return");case 2:return r.next=4,(l=X.current)===null||l===void 0?void 0:l.getGraphData();case 4:t=r.sent,t?(s=(0,M.me)(t),(0,$a.RY)("".concat(S.name,"-").concat(D,".json"),JSON.stringify((0,y.Z)((0,y.Z)({},s),{},{name:S.name,displayName:S.displayName,version:D})))):I.default.error("Get graph data failed");case 6:case"end":return r.stop()}},i)}));return function(){return d.apply(this,arguments)}}(),hn=function(){var d=(0,L.Z)(m().mark(function i(l){var t,s,x,r;return m().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,l.text();case 3:return t=o.sent,s=JSON.parse(t),x={connections:[],activities:s.activities},s!=null&&s.connections&&(x.connections=(r=s.connections)===null||r===void 0?void 0:r.map(function(N){var C,P;return{sourceId:(C=N.sourceId)!==null&&C!==void 0?C:N.sourceActivityId,targetId:(P=N.targetId)!==null&&P!==void 0?P:N.targetActivityId,outcome:N.outcome}})),o.next=9,pa(x,!0);case 9:I.default.info("import successful."),o.next=16;break;case 12:o.prev=12,o.t0=o.catch(0),console.error(o.t0),I.default.error("Import file failed");case 16:case"end":return o.stop()}},i,null,[[0,12]])}));return function(l){return d.apply(this,arguments)}}(),pn=function(){var d=(0,L.Z)(m().mark(function i(l,t){var s,x,r,F,o,N,C,P,R,w,de,K;return m().wrap(function(se){for(;;)switch(se.prev=se.next){case 0:return C=I.default.loading("Loading...."),_a("Properties - ".concat(l.displayName," (").concat(l.type,")")),un(t.id),se.next=5,(0,M.Qr)();case 5:if(P=se.sent,R=(s=P.items)===null||s===void 0?void 0:s.find(function(p){return p.type==l.type}),R){se.next=10;break}return I.default.error("The node type ".concat(l.type," not found.")),se.abrupt("return");case 10:w={name:(x=t.getProp("name"))!==null&&x!==void 0?x:"",displayName:(r=t.getProp("displayName"))!==null&&r!==void 0?r:"",description:(F=t.getProp("description"))!==null&&F!==void 0?F:"",props:{}},de=(o=t.getProp("properties"))!==null&&o!==void 0?o:[],de.forEach(function(p){var Q,ue,q=p.syntax;if(!q&&Object.keys((Q=p.expressions)!==null&&Q!==void 0?Q:{}).filter(function(Te){return Te!="$id"}).length>0){var ye;q=Object.keys((ye=p.expressions)!==null&&ye!==void 0?ye:{}).filter(function(Te){return Te!="$id"})[0]}if((ue=p.expressions)!==null&&ue!==void 0&&ue[q]){var Ye=p.expressions[q];p.value=Ye}w.props[p.name]={name:p.name,value:p.value,syntax:q,expressions:(0,ce.Z)({},q,p.value)}}),rn(R),K=(N=R.inputProperties)===null||N===void 0?void 0:N.map(function(p){return(0,y.Z)((0,y.Z)({},p),{},{isRequired:p.isDesignerCritical})}),ln(K??[]),K==null||K.forEach(function(p){var Q,ue=(0,M.Oq)(p),q=ue.defaultSyntax,ye=ue.syntaxes,Ye=p.defaultValue;(Q=w.props)!==null&&Q!==void 0&&Q[p.name]?w.props[p.name].syntax||(w.props[p.name].syntax=q):w.props[p.name]={name:p.name,syntax:q,value:Ye,expressions:(0,ce.Z)({},q,null)}}),tn(w),console.log("load form data: ",w),oe.resetFields(),oe.setFieldsValue(w),ca(!0),C();case 23:case"end":return se.stop()}},i)}));return function(l,t){return d.apply(this,arguments)}}(),xn=function(){var d=(0,L.Z)(m().mark(function i(l){var t,s,x,r,F,o,N,C,P,R,w,de,K,ee;return m().wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(console.log("save form data: ",l),x={name:l.name,displayName:l.displayName,description:l.description,properties:[],outcomes:[]},l.props)for(r in(F=l.props)!==null&&F!==void 0?F:{})C=l.props[r],P=(o=(N=C.expressions)===null||N===void 0?void 0:N[C.syntax])!==null&&o!==void 0?o:null,R="",C.expressions&&Object.keys(C.expressions).indexOf(C.syntax)>=0&&(typeof P=="object"?R=JSON.stringify(P):typeof P!="string"?R=P.toString():R=P),x.properties.push({name:r,syntax:C.syntax,expressions:(0,ce.Z)({},C.syntax,R),value:P});w=(t=Ue==null?void 0:Ue.outcomes)!==null&&t!==void 0?t:[],de=va.find(function(Q){return Q.considerValuesAsOutcomes}),de&&(ee=(K=x.properties.find(function(Q){return Q.name==de.name}))===null||K===void 0?void 0:K.value,ee&&((0,Da.isArray)(ee)?w.push.apply(w,(0,e.Z)(ee)):typeof ee=="string"&&ee.startsWith("[")&&ee.endsWith("]")&&w.push.apply(w,(0,e.Z)(JSON.parse(ee))))),x.outcomes=w,console.log("updated node: ",x),(s=X.current)===null||s===void 0||s.updateNodeProperties(dn,x);case 9:case"end":return p.stop()}},i)}));return function(l){return d.apply(this,arguments)}}(),xa=function(){var d=(0,L.Z)(m().mark(function i(){var l,t,s,x,r,F,o,N,C=arguments;return m().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return t=C.length>0&&C[0]!==void 0?C[0]:!1,u(!0),R.next=4,(l=X.current)===null||l===void 0?void 0:l.getGraphData();case 4:if(s=R.sent,(s==null?void 0:s.nodes.length)!=0){R.next=9;break}return I.default.error("No nodes in the graph"),u(!1),R.abrupt("return");case 9:if(x=(0,M.me)(s),r=x.activities,F=x.connections,o=null,!c){R.next=17;break}return R.next=14,(0,te.qr)(c,{definition:S,activities:r,connections:F,isPublished:t});case 14:o=R.sent,R.next=20;break;case 17:return R.next=19,(0,te.$u)({definition:S,activities:r,connections:F,isPublished:t});case 19:o=R.sent;case 20:o&&(c?I.default.success("Save successed. version: "+o.version):(I.default.success("Create successed."),z.replace("/designer?id=".concat((N=o.definition)===null||N===void 0?void 0:N.id))),V(o.definition.id),v(o.version)),u(!1);case 22:case"end":return R.stop()}},i)}));return function(){return d.apply(this,arguments)}}(),Zn=function(){ra("Create"),Ie(!0)},Za=function(){var d=(0,L.Z)(m().mark(function i(l,t){var s;return m().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(A(!0),!t){r.next=7;break}return r.next=4,(0,te.lE)(l,t);case 4:s=r.sent,r.next=10;break;case 7:return r.next=9,(0,te.kW)(l);case 9:s=r.sent;case 10:if(A(!1),!s){r.next=19;break}return $(s),re(s.definition),v(s.version),r.next=17,pa(s);case 17:r.next=20;break;case 19:z.goBack();case 20:case"end":return r.stop()}},i)}));return function(l,t){return d.apply(this,arguments)}}();return(0,g.useEffect)(function(){var d,i,l=(d=(i=f.query)===null||i===void 0?void 0:i.id)!==null&&d!==void 0?d:"";V(l),l?Za(l):Zn()},[]),(0,a.jsxs)(Ca.ZP,{children:[(0,a.jsx)(ge.Z,{onKeyDown:function(i){i.preventDefault();var l=String.fromCharCode(i.which).toLowerCase();(i.ctrlKey||i.metaKey)&&l==="s"&&console.log("ctrl+s")},children:(0,a.jsxs)(Se.Z,{spinning:le,children:[(0,a.jsxs)(ie.Z,{style:{marginBottom:15},children:[(0,a.jsx)(Y.Z,{flex:1,className:"title-bar",children:(0,a.jsxs)(Fe.Z.Text,{children:[S==null?void 0:S.name," ",(0,a.jsx)(W.Z,{children:(0,a.jsx)(Le.Z,{title:"Current Version",children:D})})]})}),(0,a.jsxs)(Y.Z,{children:[(0,a.jsx)(ne.Z,{type:"default",disabled:!(S!=null&&S.name),loading:B,style:{marginLeft:10},icon:(0,a.jsx)(Na.Z,{}),onClick:(0,L.Z)(m().mark(function d(){return m().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,xa();case 2:case"end":return l.stop()}},d)})),children:"Save"}),(0,a.jsx)(ne.Z,{type:"default",disabled:!(S!=null&&S.name),loading:B,style:{marginLeft:10},icon:(0,a.jsx)(ja.Z,{}),onClick:(0,L.Z)(m().mark(function d(){return m().wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,xa(!0);case 2:case"end":return l.stop()}},d)})),children:"Publish"}),(0,a.jsx)(he.Z.Button,{disabled:B||!(S!=null&&S.name),style:{marginLeft:10},onClick:function(){ra("Edit"),Ie(!0)},overlay:(0,a.jsxs)(ae.Z,{children:[(0,a.jsx)(ae.Z.Item,{onClick:function(){Be(!0)},disabled:!c,children:"Versions"},"1"),(0,a.jsx)(ae.Z.Divider,{}),(0,a.jsx)(ae.Z.Item,{onClick:function(){Sn()},children:"Export"},"2"),(0,a.jsx)(ae.Z.Item,{children:(0,a.jsx)(pe.Z,{accept:".json",showUploadList:!1,beforeUpload:function(i){return hn(i),!1},children:"Import"})},"3")]}),children:"Settings"})]})]}),(0,a.jsx)(Fa.Z,{actionRef:X,graphData:Wa,onNodeDoubleClick:pn})]})}),(0,a.jsx)(Pe.Y,{layout:"horizontal",preserve:!1,labelCol:{span:5},width:600,labelWrap:!0,title:Ga,visible:Ma,initialValues:S,onVisibleChange:Ie,onFinish:function(){var d=(0,L.Z)(m().mark(function i(l){return m().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return re((0,y.Z)((0,y.Z)({},S),l)),s.abrupt("return",!0);case 2:case"end":return s.stop()}},i)}));return function(i){return d.apply(this,arguments)}}(),children:(0,a.jsx)(Ea.Z,{})}),(0,a.jsx)(Pe.Y,{form:oe,layout:"horizontal",modalProps:{maskClosable:!1,destroyOnClose:!0},preserve:!1,labelWrap:!0,title:Aa,labelCol:{span:5},grid:!0,width:800,initialValues:Sa,visible:an,scrollToFirstError:!0,onVisibleChange:ca,onFinish:function(){var d=(0,L.Z)(m().mark(function i(l){return m().wrap(function(s){for(;;)switch(s.prev=s.next){case 0:return xn((0,y.Z)((0,y.Z)({},Sa),l)),s.abrupt("return",!0);case 2:case"end":return s.stop()}},i)}));return function(i){return d.apply(this,arguments)}}(),children:(0,a.jsx)(Ya,{workflowDefinitionId:c,properties:va,getFieldValue:oe.getFieldValue,setFieldsValue:oe.setFieldsValue,setFieldValue:function(i,l){oe.setFields([{name:i,value:l}])}})}),(0,a.jsx)(me.Z,{title:"Version History",destroyOnClose:!0,visible:gn,onCancel:function(){return Be(!1)},width:650,onOk:function(){aa?(Be(!1),I.default.loading("Loading...",1),Za(c,aa)):I.default.error("Please select a version")},children:(0,a.jsx)(Oa.ZP,{search:!1,toolBarRender:!1,rowKey:"version",columns:[{title:"Version",dataIndex:"version"},{title:"Latest",dataIndex:"isLatest",valueEnum:{true:{text:"Y"},false:{text:"-"}}},{title:"Published",dataIndex:"isPublished",valueEnum:{true:{text:"Y"},false:{text:"-"}}},{title:"Modification Time",dataIndex:"creationTime",valueType:"dateTime",renderText:function(i,l){var t;return(t=l.lastModificationTime)!==null&&t!==void 0?t:l.creationTime}}],rowSelection:{type:"radio",alwaysShowAlert:!1,onChange:function(i){if(i.length>0){var l=parseInt(i[0].toString());na(l)}}},tableAlertRender:!1,pagination:{pageSize:10},request:function(){var d=(0,L.Z)(m().mark(function i(l){var t,s,x,r;return m().wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return t=l.current,s=l.pageSize,delete l.current,delete l.pageSize,x=(t-1)*s,o.next=6,(0,te.DY)(c,{skipCount:x,maxResultCount:s});case 6:if(r=o.sent,!r){o.next=12;break}return na(void 0),o.abrupt("return",{success:!0,data:r.items,total:r.totalCount});case 12:return o.abrupt("return",{success:!1});case 13:case"end":return o.stop()}},i)}));return function(i){return d.apply(this,arguments)}}()})})]})},Ka=Ta}}]);
